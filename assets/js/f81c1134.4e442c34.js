"use strict";(self.webpackChunkvosrde_github_io=self.webpackChunkvosrde_github_io||[]).push([[130],{7735:e=>{e.exports=JSON.parse('{"archive":{"blogPosts":[{"id":"oem-license-key","metadata":{"permalink":"/blog/oem-license-key","source":"@site/blog/2020-01-31-oem-license-key.md","title":"Set OEM license key during deployment","description":"Since a couple of years computer manufacturers stopped pasting the Certificate of Authenticity sticker, containing the product key to the device. The product key is now embedded in the BIOS/UEFI.","date":"2020-01-31T00:00:00.000Z","tags":[{"inline":false,"label":"Windows 10","permalink":"/blog/tags/windows10","description":"Windows 10 tag description"},{"inline":false,"label":"Intune","permalink":"/blog/tags/intune","description":"Intune tag description"},{"inline":false,"label":"Configuration Manager","permalink":"/blog/tags/configmgr","description":"Configuration Manager tag description"}],"readingTime":0.79,"hasTruncateMarker":true,"authors":[{"name":"Ralph de Vos","title":"Workplace Consultant @ Wortell","url":"https://github.com/vosrde","page":{"permalink":"/blog/authors/ralph"},"socials":{"x":"https://x.com/vosrde","github":"https://github.com/vosrde"},"imageURL":"https://github.com/vosrde.png","key":"ralph"}],"frontMatter":{"slug":"oem-license-key","title":"Set OEM license key during deployment","authors":["ralph"],"tags":["windows10","intune","configmgr"]},"unlisted":false},"content":"Since a couple of years computer manufacturers stopped pasting the Certificate of Authenticity sticker, containing the product key to the device. The product key is now embedded in the BIOS/UEFI.\\n\\n\x3c!-- truncate --\x3e\\n\\nTo use this product key during a task sequence we need to query it from the BIOS/UEFI using Windows Management Instrumentation (WMI). Using PowerShell, After this, we can use it with the slmgr.vbs script to install the productkey and activate Windows.\\n\\nTo get the product key, you need to query the SoftwareLicensingService class of the root\\\\CIMv2 namespace. The productkey is stored in the OA3xOriginalProductKey property. Below is a small PowerShell script to query the ProductKey and activate Windows.\\n\\n```\\n$ProductKey = (Get-WMIObject -Class SoftwareLicensingService).OA3xOriginalProductKey\\nif($ProductKey) {\\n  Invoke-Expression -Command \\"cscript.exe /b $($env:windir)\\\\system32\\\\slmgr.vbs /ipk $ProductKey\\"\\n  Start-Sleep 15\\n  Invoke-Expression -Command \\"cscript.exe /b $($env:windir)\\\\system32\\\\slmgr.vbs /ato\\"\\n}\\n```\\nThis activation method is especially useful when using Microsoft 365 subscription based licensing, as it requires an activated Windows 10 Pro installation."}]}}')}}]);